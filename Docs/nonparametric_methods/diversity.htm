<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" class="_Skins_SD_Web_Skin" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../" data-mc-has-content-body="True" data-mc-toc-path="Nonparametric methods" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msvalidate.01" content="9D4F037DF99C5A667F6C18BED78768E6" /><title>Diversity of Classes (Shannon, Simpson, Species) - StatsDirect</title>
        <link rel="shortcut icon" href="../resources/Images/sd3.ico" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/stylesheets/print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../resources/stylesheets/statsdirect.css" rel="stylesheet" type="text/css" />
        <script src="../resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../contents.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div role="main" id="mc-main-content">
                                        <h1><a name="kanchor228"></a>Diversity of Classes</h1>
                                        <p>&#160;</p>
                                        <p>Menu location: <b>Analysis_Nonparametric_Diversity of Classes</b></p>
                                        <p>&#160;</p>
                                        <p>This function calculates measures of diversity and an estimate of the number of classes in the population given a list of counts of observations in each class from a sample of the population.</p>
                                        <p>&#160;</p>
                                        <p>Most of the statistical theory used here originates from work in economics (<a href="../references/reference_list.htm">Gini, 1912</a>) and information science (<a href="../references/reference_list.htm">Shannon, 1948</a>), and has been developed further in ecology, and genetics. Ecological applications usually involve studies of biodiversity, therefore the classes are species or other taxa (pl.  taxon, group used by a taxonomist). In genetics the classes could be alleles (any of two or more alternative forms of a gene occupying the same chromosomal locus). These principles have been applied to other areas of study such as microbiology (<a href="../references/reference_list.htm">Hunter and Gaston, 1988; Grundmann et al., 2001</a>), and potentially to many more, such as community development.</p>
                                        <p>&#160;</p>
                                        <p>This area of study is fraught with potential confusion over terms used to describe concepts. Diversity (or heterogeneity) includes both richness (the number of classes) and evenness (the distribution of individuals among classes). The most useful descriptions of diversity, therefore, present both measures of richness and evenness.</p>
                                        <p>&#160;</p>
                                        <p>Two commonly used measures Simpson's index D<sub>s</sub> and Shannon's index H'. There are many more indices and none is best for all applications (<a href="../references/reference_list.htm">Hurlbert, 1971; Smith, 2002; Kempton, 2002; Brower et al., 1998; Krebs, 1989; Mouillot and Leprêtre, 1999</a>). Common weaknesses of some of these indices are dependence upon a model of class abundance that you don't know in advance, variation with sample size, poor discriminatory ability for specific applications, or poor theoretical justification.</p>
                                        <p>&#160;</p>
                                        <p>Simpson's index Ds (equal to one minus Simpson's original measure of dominance, l, later proposed by Hurlbert as PIE, the probability of inter-specific encounter) is the most meaningful measure of evenness. D<sub>s</sub> is the probability that two randomly sampled individuals are from two different classes. This is equivalent to the genetic calculation of heterozygosity, H, being the probability that two alleles are not identical by descent. It follows that 1-D<sub>s</sub>, or dominance l, is the probability that two randomly sampled individuals are from the same class.</p>
                                        <p>
                                            <img src="../generatedimages/equations/equation158.svg" alt="" class="mcReset" />
                                        </p>
                                        <p>- where s is the number of classes observed, n<sub>i</sub> is the number observed from the ith class and N is the total number of individuals observed in the sample. Note that Hurlbert (1971) gives a different form of this equation and that the one above is better because it reduces rounding error by reducing the amount of intermediate division.</p>
                                        <p>&#160;</p>
                                        <p>The variance for D<sub>s</sub> can be estimated as:</p>
                                        <p>
                                            <img src="../generatedimages/equations/equation159.svg" alt="" class="mcReset" />
                                        </p>
                                        <p>- the second formula above gives better variance estimates for small samples than does the first (<a href="../references/reference_list.htm">Simpson, 1949; Brower, 1998</a>).</p>
                                        <p>&#160;</p>
                                        <p>Shannon's index of diversity H' is derived from information theory, originally in the context of information in telephone systems (<a href="../references/reference_list.htm">Shannon, 1948</a>). It combines both evenness and richness in a single measure. H' has no intuitive interpretation in terms of probability and is sensitive to sample size. H' was once thought to be a measure of entropy, but this is no longer supported (<a href="../references/reference_list.htm">Hurlbert, 1971, Goodman 1975</a>). H' can lead to confounded comparisons where the investigator can not infer whether or not differences in H' are due to differences in richness, diversity or just sampling differences. StatsDirect calculates H' solely for consistency because it has been used widely in the past.</p>
                                        <p>
                                            <img src="../generatedimages/equations/equation160.svg" alt="" class="mcReset" />
                                        </p>
                                        <p>- where s is the number of classes observed,  n<sub>i</sub> is the number observed from the ith class and N is the total number of individuals observed in the sample. Note that some authors use different bases for the logarithms, giving differently scaled results, but it makes no difference which is used provided you are consistent. If you want to convert the natural log results of StatsDirect to log (base 10) results then simply multiply H' by 0.4343.</p>
                                        <p>&#160;</p>
                                        <p>The variance for H' can be estimated as:</p>
                                        <p>
                                            <img src="../generatedimages/equations/equation161.svg" alt="" class="mcReset" />
                                        </p>
                                        <p>- the second formula above gives better variance estimates for small samples than does the first (<a href="../references/reference_list.htm">Shannon, 1948; Nayak, 1985; Pardo et al. 1997</a>). Note that there is an error in the second formula in <a href="../references/reference_list.htm">Brower et al. (1998)</a>.</p>
                                        <p>&#160;</p>
                                        <p>The large sample variance estimates above are used to calculate confidence intervals for Ds and H'. These asymptotic estimates of variance do not perform well with small samples, which can be compensated for using the small sample adjustments shown above. A better approach is to use bootstrap confidence intervals in order to get as much information as possible out of your sample. StatsDirect calculates two types of bootstrap confidence intervals for diversity indices, these are the bootstrap refinement of the normal asymptotic interval (<a href="../references/reference_list.htm">Mills and Zandvakili, 1997; Dixon et al., 1987; Efron and Tibshirani, 1997</a>):</p>
                                        <p>
                                            <img src="../generatedimages/equations/equation162.svg" alt="" class="mcReset" />
                                        </p>
                                        <p>- where g is either the Simpson or Shannon statistic calculated from the observed sample, k is the number bootstrap resamples, g star is the statistic of interest calculated from a bootstrap sample, SE<sub>b</sub> is the bootstrap estimate of standard error and t is a quantile of the Student t distribution.</p>
                                        <p>&#160;</p>
                                        <p>…and a the symmetrized bootstrap-t interval (<a href="../references/reference_list.htm">Vives et al., 2002; Hall 1988</a>):</p>
                                        <p>
                                            <img src="../generatedimages/equations/equation163.svg" alt="" class="mcReset" />
                                        </p>
                                        <p>- where G is the estimated bootstrap distribution of the absolute value of the studentized sample diversity index.</p>
                                        <p>&#160;</p>
                                        <p>The resampling scheme used for the bootstrap intervals above is the allocation of one observation to each of s classes followed by allocation at random of the remaining N-s observations to the s classes. This scheme keeps a constant number of classes in each bootstrap sample.</p>
                                        <p>&#160;</p>
                                        <p><a href="../references/reference_list.htm">Vives et al. (2002)</a> showed that percentile methods (including BCa) do not perform well for Shannon's index, they advise using a symmetrized bootstrap-t confidence interval.</p>
                                        <p>&#160;</p>
                                        <p>StatsDirect also extrapolates the richness (number of classes) in your sample in order to give an estimate of the number of classes in the population. There are different approaches to this extrapolation, a well-founded method that does not assume a model of class abundance is that of <a href="../references/reference_list.htm">Chao (1984)</a> as discussed by <a href="../references/reference_list.htm">Colwell and Coddington (1994)</a>.</p>
                                        <p>
                                            <img src="../generatedimages/equations/equation164.svg" alt="" class="mcReset" />
                                        </p>
                                        <p>- where S is the estimate of the total number of classes in the population, s is the number of classes observed in the sample, a is the number of classes with exactly one individual (singletons), b is the number of classes with exactly two individuals (doubletons), and where 1 is substituted for a or b if either has no singletons or doubletons.</p>
                                        <p>&#160;</p>
                                        <p><u>Example</u>
                                        </p>
                                        <p>Test workbook (Nonparametric worksheet: Community (RAPD)).</p>
                                        <p>&#160;</p>
                                        <p>Consider the following counts of numbers of types of Staphylococcus aureus strains found in hospital samples (<a href="../references/reference_list.htm">Grundmann et al., 2001</a>).</p>
                                        <table>
                                            <col />
                                            <col />
                                            <col />
                                            <col />
                                            <tr>
                                                <td style="text-align: right;">CR1</td>
                                                <td style="text-align: right;">30</td>
                                                <td style="text-align: right;">CR8</td>
                                                <td style="text-align: right;">6</td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: right;">CR2</td>
                                                <td style="text-align: right;">13</td>
                                                <td style="text-align: right;">CR9</td>
                                                <td style="text-align: right;">6</td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: right;">CR3</td>
                                                <td style="text-align: right;">9</td>
                                                <td style="text-align: right;">CR10</td>
                                                <td style="text-align: right;">5</td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: right;">CR4</td>
                                                <td style="text-align: right;">8</td>
                                                <td style="text-align: right;">CR11</td>
                                                <td style="text-align: right;">2</td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: right;">CR5</td>
                                                <td style="text-align: right;">7</td>
                                                <td style="text-align: right;">CR12</td>
                                                <td style="text-align: right;">2</td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: right;">CR6</td>
                                                <td style="text-align: right;">7</td>
                                                <td style="text-align: right;">CR13</td>
                                                <td style="text-align: right;">2</td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: right;">CR7</td>
                                                <td style="text-align: right;">7</td>
                                                <td style="text-align: right;">CR14-26</td>
                                                <td style="text-align: right;">1</td>
                                            </tr>
                                        </table>
                                        <p>&#160;</p>
                                        <p>To test these data for diversity using StatsDirect you must first prepare them in a workbook column. Alternatively, open the test workbook using the file open function of the file menu. Then select the Diversity item from the Nonparametric section of the analysis menu. <a href="../workbook/selecting_data.htm">Select</a> the column marked "Community (RAPD)" when prompted for data.</p>
                                        <p>&#160;</p>
                                        <p>For this example:</p>
                                        <p>&#160;</p>
                                        <p><u>Analysis for Community (RAPD)</u>
                                        </p>
                                        <p>&#160;</p>
                                        <p>Total number of counts = 117</p>
                                        <p>Number of classes observed (richness) = 26</p>
                                        <p>&#160;</p>
                                        <p>Estimated total number of classes = 54</p>
                                        <p>Standard error (large sample) = 16.196498</p>
                                        <p>Normal (large sample) 95% CI = 22 to 86</p>
                                        <p>&#160;</p>
                                        <p><b>Simpson Ds (Hurlburt PIE)</b> = 0.899352, (dominance l = 0.100648,  ds = 9.935578)</p>
                                        <p>Standard error (large sample) = 0.016826</p>
                                        <p>Standard error (small sample) = 0.017173</p>
                                        <p>Normal (large sample) 95% CI = 0.866373 to 0.932331</p>
                                        <p>Re-samples = 2000, bias = -0.022018, standard error (bootstrap) = 0.011455</p>
                                        <p>Normal (bootstrap) 95% CI = 0.876886 to 0.921817</p>
                                        <p>&#160;</p>
                                        <p><b>Shannon H' (base e)</b> = 2.656515</p>
                                        <p>Standard error (large sample) = 0.095839</p>
                                        <p>Standard error (small sample) = 0.10049</p>
                                        <p>Normal (large sample) 95% CI = 2.468673 to 2.844356</p>
                                        <p>Re-samples = 2000, bias = -0.16601, standard error (bootstrap) = 0.065119</p>
                                        <p>Normal (bootstrap) 95% CI = 2.528806 to 2.784223</p>
                                        <p>&#160;</p>
                                        <p><a href="../basics/confidence_interval.htm">confidence intervals</a>
                                        </p>
                                    </div>
                                    <MadCap:pageFooter>
                                        <p style="font-family: sans-serif;font-size: 8pt;margin-top:20pt;">Copyright © 1987-2025 Iain E. Buchan, all rights reserved. <a href="https://www.statsdirect.com/Download.aspx">Download software here</a>.</p>
                                    </MadCap:pageFooter>
                                    <!-- Google tag (gtag.js) -->
                                    <script type="text/javascript" async="async" src="https://www.googletagmanager.com/gtag/js?id=G-GZZ7X1JX4D">
                                    </script>
                                    <script type="text/javascript">/* <![CDATA[ */
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-GZZ7X1JX4D');
        /* ]]> */</script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>