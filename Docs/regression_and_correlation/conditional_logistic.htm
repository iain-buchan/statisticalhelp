<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../" data-mc-toc-path="Regression and correlation" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="google-site-verification" content="u8VujUYHtRg-etTtMaOxGADUJTyzVkeViXdOFtgt1nU" />
        <meta name="msvalidate.01" content="9D4F037DF99C5A667F6C18BED78768E6" /><title>Conditional (Matched) Logistic Regression - StatsDirect</title>
        <link rel="shortcut icon" href="../resources/Images/sd3.ico" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../resources/stylesheets/statsdirect.css" rel="stylesheet" type="text/css" />
        <script src="../resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/foundation.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../index.html#regression_and_correlation/conditional_logistic.htm">Open topic with navigation</a>
        </p>
        <div role="main" id="mc-main-content">
            <h1><a name="kanchor184"></a>Conditional Logistic Regression</h1>
            <p>&#160;</p>
            <p>Menu location: <b>Analysis_Regression and Correlation_Conditional Logistic</b>.</p>
            <p>&#160;</p>
            <p>This function fits and analyses conditional logistic models for binary outcome/response data with one or more predictors, where observations are not independent but are matched or grouped in some way.</p>
            <p>&#160;</p>
            <p><a href="../distributions/binomial.htm">Binomial distributions</a> are used for handling the errors associated with regression models for binary/dichotomous responses (i.e. yes/no, dead/alive) in the same way that the <a href="../distributions/normal.htm">standard normal distribution</a> is used in <a href="multiple_linear.htm">general linear regression</a>. Other, less commonly used binomial models include normit/probit and complimentary log-log. The logistic model is widely used and has many desirable properties (<a href="../references/reference_list.htm">Hosmer and Lemeshow, 1989; Armitage and Berry, 1994; Altman 1991; McCullagh and Nelder, 1989; Cox and Snell, 1989; Pregibon, 1981</a>).</p>
            <p>&#160;</p>
            <p>Odds = π/(1-π)</p>
            <p>[π = proportional response, i.e. r out of n responded so π = r/n]</p>
            <p>Logit = log odds = log(π/(1-π))</p>
            <p>&#160;</p>
            <p>When a logistic regression model has been fitted, estimates of p are marked with a hat symbol above the Greek letter pi to denote that the proportion is estimated from the fitted regression model. Fitted proportional responses are often referred to as event probabilities (i.e. π hat n events out of n trials).</p>
            <p>&#160;</p>
            <p>The following information about the difference between two logits demonstrates one of the important uses of logistic regression models:</p>
            <p>
                <img src="../generatedimages/equations/equation206.svg" alt="" class="mcReset" />
            </p>
            <p>&#160;</p>
            <p>Logistic models provide important information about the relationship between response/outcome and exposure. It makes no difference to logistic models, whether outcomes have been sampled prospectively or retrospectively, this is not the case with other binomial models.</p>
            <p>&#160;</p>
            <p>The conditional logistic model can cope with 1:1 or 1:m case-control matching. In the simplest case, this is an extension of <a href="../chi_square_tests/mcnemar.htm">McNemar's test</a> for matched studies.</p>
            <p>&#160;</p>
            <p><u>Data preparation</u>
            </p>
            <p>You must prepare your data case by case, i.e. ungrouped, one subject/observation per row, this is unlike the unconditional logistic function that accepts grouped or ungrouped data.</p>
            <p>&#160;</p>
            <p>The binary outcome variable must contain only 0 (control) or 1 (case).</p>
            <p>&#160;</p>
            <p>There must be a stratum indicator variable to denote the strata. In case-control studies with 1:1 matching this would mean a code for each pair (i.e. two rows marked stratum x, one with a case + covariates and the other with a control + covariates). For 1:m matched studies there will be 1+m rows of data for each stratum/matching-group.</p>
            <p>&#160;</p>
            <p><u>Technical validation</u>
            </p>
            <p>The regression is fitted by maximisation of the natural logarithm of the conditional likelihood function using Newton-Raphson iteration as described by <a href="../references/reference_list.htm">Krailo et al. (1984), Smith et al. (1981) and Howard (1972)</a>.</p>
            <p>&#160;</p>
            <p><u>Example</u>
            </p>
            <p>From <a href="../references/reference_list.htm">Hosmer and Lemeshow (1989)</a>.</p>
            <p>Test workbook (Regression worksheet: PAIRID, LBWT, RACE (b), SMOKE, HT, UI, PTD, LWT).</p>
            <p>&#160;</p>
            <p>These are artificially matched data from a study of the risk factors associated with low birth weight in Massachusetts in 1986. The predictors studied here are black race (RACE (b)), smoking status (SMOKE), hypertension (HT), uterine irritability (UI), previous preterm delivery (PTD) and weight of the mother at her last menstrual period (LWT).</p>
            <p>&#160;</p>
            <p>To analyse these data using StatsDirect you must first open the test workbook using the file open function of the file menu. Then select Conditional Logistic from the Regression and Correlation section of the analysis menu. <a href="../workbook/selecting_data.htm">Select</a> the column marked "PAIRID" when asked for the stratum (match group) indicator. Then select "LBWT" when asked for the case-control indicator. Then select "RACE (b)", "SMOKE", "HT", "UI", "PTD", and "LWT" in one action when you are asked for predictors. </p>
            <p>&#160;</p>
            <p>For this example:</p>
            <p>&#160;</p>
            <p><u>Conditional logistic regression</u>
            </p>
            <p>&#160;</p>
            <p>Deviance (-2 log likelihood) = 51.589852 </p>
            <p>Deviance (likelihood ratio) chi-square = 26.042632 P = 0.0002</p>
            <p>Pseudo (McFadden) R-square = 0.33546</p>
            <p>&#160;</p>
            <table>
                <col style="width: 75px;" />
                <col />
                <col />
                <col />
                <col />
                <tr>
                    <td style="text-decoration: underline;">Label</td>
                    <td style="text-decoration: underline;">Parameter estimate</td>
                    <td style="text-decoration: underline;">Standard error</td>
                    <td>&#160;</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td>RACE (b)</td>
                    <td>0.582272</td>
                    <td>0.620708</td>
                    <td>z = 0.938078</td>
                    <td>P = 0.3482</td>
                </tr>
                <tr>
                    <td>SMOKE</td>
                    <td>1.410799</td>
                    <td>0.562177</td>
                    <td>z = 2.509528</td>
                    <td>P = 0.0121</td>
                </tr>
                <tr>
                    <td>HT</td>
                    <td>2.351335</td>
                    <td>1.05135</td>
                    <td>z = 2.236492</td>
                    <td>P = 0.0253</td>
                </tr>
                <tr>
                    <td>UI</td>
                    <td>1.399261</td>
                    <td>0.692244</td>
                    <td>z = 2.021341</td>
                    <td>P = 0.0432</td>
                </tr>
                <tr>
                    <td>PTD</td>
                    <td>1.807481</td>
                    <td>0.788952</td>
                    <td>z = 2.290989</td>
                    <td>P = 0.022</td>
                </tr>
                <tr>
                    <td>LWT</td>
                    <td>-0.018222</td>
                    <td>0.00913</td>
                    <td>z = -1.995807</td>
                    <td>P = 0.046</td>
                </tr>
            </table>
            <p>&#160;</p>
            <table>
                <col />
                <col />
                <col />
                <tr>
                    <td style="text-decoration: underline;">Label</td>
                    <td style="text-decoration: underline;">Odds ratio</td>
                    <td style="text-decoration: underline;">95% confidence interval</td>
                </tr>
                <tr>
                    <td>RACE (b)</td>
                    <td>1.790102</td>
                    <td>0.53031 to 6.042622</td>
                </tr>
                <tr>
                    <td>SMOKE</td>
                    <td>4.099229</td>
                    <td>1.361997 to 12.337527</td>
                </tr>
                <tr>
                    <td>HT</td>
                    <td>10.499579</td>
                    <td>1.3374 to 82.429442</td>
                </tr>
                <tr>
                    <td>UI</td>
                    <td>4.052205</td>
                    <td>1.043404 to 15.737307</td>
                </tr>
                <tr>
                    <td>PTD</td>
                    <td>6.095073</td>
                    <td>1.298439 to 28.611218</td>
                </tr>
                <tr>
                    <td>LWT</td>
                    <td>0.981943</td>
                    <td>0.964529 to 0.999673</td>
                </tr>
            </table>
            <p>&#160;</p>
            <p>You may infer from the results above that hypertension, smoking status and previous pre-term delivery are convincing predictors of low birth weight in the population studied.</p>
            <p>&#160;</p>
            <p>Note that the selection of predictors for regression models such as this can be complex and is best done with the help of a Statistician. <a href="../references/reference_list.htm">Hosmer and Lemeshow (1989)</a> give a good discussion of the example above, but with non-standard dummy variables (StatsDirect uses a standard dummy/design variable coding scheme adopted by most other statistical software). The optimal selection of predictors depends not only upon their numerical performance in the model, with or without appropriate transformations or study of interactions, but also upon their biophysical importance in the study.</p>
            <p>&#160;</p>
            <p><a href="../basics/p_values.htm">P values</a>
            </p>
            <p><a href="../basics/confidence_interval.htm">confidence intervals</a>
            </p>
        </div>
        <p>
            <MadCap:pageFooter>
                <p style="font-family: sans-serif;font-size: 6pt;">&#160;</p>
                <p style="font-family: sans-serif;font-size: 8pt;">&#160;</p>
                <p style="font-family: sans-serif;font-size: 8pt;"><span style="font-size: 8pt;">Copyright © 1987-2025 Iain E. Buchan, all rights reserved. </span><a href="https://www.statsdirect.com/Download.aspx" style="font-size: 8pt;">Download software here</a><span style="font-size: 8pt;">.</span>
                </p>
            </MadCap:pageFooter>
        </p>
    </body>
    <script type="text/javascript">/* <![CDATA[ */
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-45008526-2']);
		_gaq.push(['_trackPageview']);
		(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	/* ]]> */</script>
</html>