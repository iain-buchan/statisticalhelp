<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../" data-mc-toc-path="Regression and correlation" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="google-site-verification" content="u8VujUYHtRg-etTtMaOxGADUJTyzVkeViXdOFtgt1nU" />
        <meta name="msvalidate.01" content="9D4F037DF99C5A667F6C18BED78768E6" /><title>Polynomial Regression - StatsDirect</title>
        <link rel="shortcut icon" href="../resources/Images/sd3.ico" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../resources/stylesheets/statsdirect.css" rel="stylesheet" type="text/css" />
        <script src="../resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/foundation.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../index.html#regression_and_correlation/polynomial.htm">Open topic with navigation</a>
        </p>
        <div role="main" id="mc-main-content">
            <h1><a name="kanchor136"></a>
            Polynomial Regression</h1>
            <p>&#160;</p>
            <p>Menu location: <b>Analysis_Regression and Correlation_Polynomial</b>.</p>
            <p>&#160;</p>
            <p>This function fits a polynomial regression model to powers of a single predictor by the method of linear least squares. Interpolation and calculation of areas under the curve are also given.</p>
            <p>&#160;</p>
            <p>If a polynomial model is appropriate for your study then you may use this function to fit a k order/degree polynomial to your data:</p>
            <p>
                <img src="../generatedimages/equations/equation192.svg" alt="" class="mcReset" />
            </p>
            <p>- where Y caret is the predicted outcome value for the polynomial model with regression coefficients b<sub>1</sub> to k for each degree and Y intercept b<sub>0</sub>. The model is simply a <a href="multiple_linear.htm">general linear regression</a> model with k predictors raised to the power of i where i=1 to k. A second order (k=2) polynomial forms a quadratic expression (parabolic curve), a third order (k=3) polynomial forms a cubic expression and a fourth order (k=4) polynomial forms a quartic expression. See <a href="../references/reference_list.htm">Kleinbaum et al. (1998)</a> and <a href="../references/reference_list.htm">Armitage and Berry (1994)</a> for more information.</p>
            <p>&#160;</p>
            <p>Some general principles:</p>
            <ul>
                <li>the fitted model is more reliable when it is built on large numbers of observations.</li>
                <li>do not extrapolate beyond the limits of observed values.</li>
                <li>choose values for the predictor (x) that are not too large as they will cause overflow with higher degree polynomials; scale x down if necessary.</li>
                <li>do not draw false confidence from low P values, use these to support your model only if the plot looks reasonable.</li>
            </ul>
            <p>&#160;</p>
            <p>More complex expressions involving polynomials of more than one predictor can be achieved by using the <a href="multiple_linear.htm">general linear regression</a> function. For more detail from the regression, such as analysis of residuals, use the general linear regression function. To achieve a polynomial fit using general linear regression you must first create new workbook columns that contain the predictor (x) variable raised to powers up to the order of polynomial that you want. For example, a second order fit requires input data of Y, x and x².</p>
            <p>&#160;</p>
            <p><u>Model fit and intervals</u>
            </p>
            <p>Subjective goodness of fit may be assessed by plotting the data and the fitted curve. An analysis of variance is given via the analysis option; this reflects the overall fit of the model. Try to use as few degrees as possible for a model that achieves significance at each degree.</p>
            <p>&#160;</p>
            <p>The plot function supplies a basic plot of the fitted curve and a plot with confidence bands and prediction bands. You can save the fitted Y values with their standard errors, confidence intervals and prediction intervals to a workbook.</p>
            <p>&#160;</p>
            <p><u>Area under curve</u>
            </p>
            <p>The option to calculate the area under the fitted curve employs two different methods. The first method integrates the fitted polynomial function from the lowest to the highest observed predictor (x) value using Romberg's integration. The second method uses the trapezoidal rule directly on the data to provide a crude estimate.</p>
            <p>&#160;</p>
            <p><u>Technical Validation</u>
            </p>
            <p>StatsDirect uses QR decomposition by Givens rotations to solve the linear equations to a high level of accuracy (<a href="../references/reference_list.htm">Gentleman, 1974; Golub and Van Loan, 1983</a>). If the QR method fails (rare) then StatsDirect will solve the system by singular value decomposition (<a href="../references/reference_list.htm">Chan, 1982</a>).</p>
            <p>&#160;</p>
            <p><u>Example</u>
            </p>
            <p>From <a href="../references/reference_list.htm">McClave and Deitrich (1991, p. 753)</a>.</p>
            <p>Test workbook (Regression worksheet: Home Size, KW Hrs/Mnth).</p>
            <p>&#160;</p>
            <p>Here we use an example from the physical sciences to emphasise the point that polynomial regression is mostly applicable to studies where environments are highly controlled and observations are made to a specified level of tolerance. The data below are the electricity consumptions in kilowatt-hours per month from ten houses and the areas in square feet of those houses:</p>
            <p>&#160;</p>
            <table cellspacing="0" style="caption-side: top;">
                <col />
                <col />
                <tr>
                    <td style="text-decoration: underline;">Home Size</td>
                    <td style="text-decoration: underline;">KW Hrs/Mnth</td>
                </tr>
                <tr>
                    <td>1290</td>
                    <td>1182</td>
                </tr>
                <tr>
                    <td>1350</td>
                    <td>1172</td>
                </tr>
                <tr>
                    <td>1470</td>
                    <td>1264</td>
                </tr>
                <tr>
                    <td>1600</td>
                    <td>1493</td>
                </tr>
                <tr>
                    <td>1710</td>
                    <td>1571</td>
                </tr>
                <tr>
                    <td>1840</td>
                    <td>1711</td>
                </tr>
                <tr>
                    <td>1980</td>
                    <td>1804</td>
                </tr>
                <tr>
                    <td>2230</td>
                    <td>1840</td>
                </tr>
                <tr>
                    <td>2400</td>
                    <td>1956</td>
                </tr>
                <tr>
                    <td>2930</td>
                    <td>1954</td>
                </tr>
            </table>
            <p>&#160;</p>
            <p>To analyse these data in StatsDirect you must first prepare them in two workbook columns appropriately labelled. Alternatively, open the test workbook using the file open function of the file menu. Then select Polynomial from the Regression and Correlation section of the analysis menu. <a href="../workbook/selecting_data.htm">Select</a> the column marked "KW hrs/mnth" when asked for the outcome (Y) variable and select the column marked "Home size" when asked for the predictor (x) variable. Enter the order of this polynomial as 2.</p>
            <p>&#160;</p>
            <p>For this example:</p>
            <p>&#160;</p>
            <p><u>Polynomial regression</u>
            </p>
            <p>&#160;</p>
            <table cellspacing="0" style="caption-side: top;">
                <col />
                <col />
                <col />
                <col />
                <tr>
                    <td>Intercept</td>
                    <td>b0= -1216.143887</td>
                    <td>t = -5.008698</td>
                    <td>P = .0016</td>
                </tr>
                <tr>
                    <td>Home Size</td>
                    <td>b1= 2.39893</td>
                    <td>t = 9.75827</td>
                    <td>P &lt; .0001</td>
                </tr>
                <tr>
                    <td>Home Size^2</td>
                    <td>b2= -0.00045</td>
                    <td>t = -7.617907</td>
                    <td>P = .0001</td>
                </tr>
            </table>
            <p>&#160;</p>
            <p>KW Hrs/Mnth = -1216.143887 +2.39893 Home Size -0.00045 Home Size^2</p>
            <p>&#160;</p>
            <p><u>Analysis of variance from regression</u>
            </p>
            <p>&#160;</p>
            <table cellspacing="0" style="caption-side: top;">
                <col />
                <col />
                <col />
                <col />
                <tr>
                    <td style="text-decoration: underline;">Source of variation</td>
                    <td style="text-decoration: underline;">Sum Squares</td>
                    <td style="text-decoration: underline;">DF</td>
                    <td style="text-decoration: underline;">Mean Square</td>
                </tr>
                <tr>
                    <td>Regression</td>
                    <td>831069.546371</td>
                    <td>2</td>
                    <td>415534.773185</td>
                </tr>
                <tr>
                    <td>Residual</td>
                    <td>15332.553629</td>
                    <td>7</td>
                    <td>2190.364804</td>
                </tr>
                <tr>
                    <td>Total (corrected)</td>
                    <td>846402.1</td>
                    <td>9</td>
                    <td>&#160;</td>
                </tr>
            </table>
            <p>&#160;</p>
            <p>Root MSE = 46.801333</p>
            <p>&#160;</p>
            <p>F = 189.710304 P &lt; .0001</p>
            <p>&#160;</p>
            <table cellspacing="0" width="353">
                <col />
                <col />
                <tr>
                    <td>
                        <p>Multiple correlation coefficient</p>
                    </td>
                    <td>
                        <p>(R) = 0.990901</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>&#160;</p>
                    </td>
                    <td>
                        <p>R² = 98.188502%</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>&#160;</p>
                    </td>
                    <td>
                        <p>Ra² = 97.670932%</p>
                    </td>
                </tr>
            </table>
            <p>&#160;</p>
            <p>Durbin-Watson test statistic = 1.63341</p>
            <p>&#160;</p>
            <p><u>Polynomial regression - area under curve</u>
            </p>
            <p>&#160;</p>
            <p>AUC (polynomial function) = 2855413.374801</p>
            <p>&#160;</p>
            <p>AUC (by trapezoidal rule) = 2838195</p>
            <p>&#160;</p>
            <p>Thus, the overall regression and both degree coefficients are highly significant.</p>
            <p>&#160;</p>
            <p><u>Plots</u>
            </p>
            <p>
                <img src="../resources/images/polynomialcurve.gif" width="517" height="365" border="0" />
            </p>
            <p>&#160;</p>
            <p>
                <img src="../resources/images/polynolialci.gif" width="517" height="365" border="0" />
            </p>
            <p>&#160;</p>
            <p>
                <img src="../resources/images/polynomialpi.gif" width="517" height="365" border="0" />
            </p>
            <p>&#160;</p>
            <p>N.B.&#160;Look at a plot of this data curve. The right hand end shows a very sharp decline. If you were to extrapolate beyond the data, you have observed then you might conclude that very large houses have very low electricity consumption. This is obviously wrong. Polynomials are frequently illogical for some parts of a fitted curve. You must blend common sense, art and mathematics when fitting these models! Remember the general principles listed above.</p>
            <p>&#160;</p>
            <p><a href="../basics/p_values.htm">P values</a>
            </p>
            <p><a href="nonlinear.htm">non-linear models</a>
            </p>
        </div>
        <p>
            <MadCap:pageFooter>
                <p style="font-family: sans-serif;font-size: 6pt;">&#160;</p>
                <p style="font-family: sans-serif;font-size: 8pt;">&#160;</p>
                <p style="font-family: sans-serif;font-size: 8pt;"><span style="font-size: 8pt;">Copyright © 1987-2025 Iain E. Buchan, all rights reserved. </span><a href="https://www.statsdirect.com/Download.aspx" style="font-size: 8pt;">Download software here</a><span style="font-size: 8pt;">.</span>
                </p>
            </MadCap:pageFooter>
        </p>
    </body>
    <script type="text/javascript">/* <![CDATA[ */
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-45008526-2']);
		_gaq.push(['_trackPageview']);
		(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	/* ]]> */</script>
</html>