<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../" data-mc-toc-path="Regression and correlation" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="google-site-verification" content="u8VujUYHtRg-etTtMaOxGADUJTyzVkeViXdOFtgt1nU" />
        <meta name="msvalidate.01" content="9D4F037DF99C5A667F6C18BED78768E6" /><title>Grouped Linear Regression with Covariance Analysis - StatsDirect</title>
        <link rel="shortcut icon" href="../resources/Images/sd3.ico" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../resources/stylesheets/statsdirect.css" rel="stylesheet" type="text/css" />
        <script src="../resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/foundation.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../index.html#regression_and_correlation/grouped_covariance.htm">Open topic with navigation</a>
        </p>
        <div role="main" id="mc-main-content">
            <h1><a name="kanchor25"></a>Grouped Linear Regression with Covariance Analysis</h1>
            <p>&#160;</p>
            <p>Menu location: <b>Analysis_Regression and Correlation_Grouped Linear_Covariance</b>.</p>
            <p>&#160;</p>
            <p>This function compares the slopes and separations of two or more simple linear regression lines.</p>
            <p>&#160;</p>
            <p>The method involves examination of regression parameters for a group of xY pairs in relation to a common fitted function. This provides an analysis of variance that shows whether or not there is a significant difference between the slopes of the individual regression lines as a whole. StatsDirect then compares all of the slopes individually. The vertical distance between each regression line is then examined using analysis of covariance and the corrected means are given (<a href="../references/reference_list.htm">Armitage and Berry, 1994</a>).</p>
            <p>&#160;</p>
            <p>Assumptions:</p>
            <ul>
                <li>Y replicates are a random sample from a normal distribution</li>
                <li>deviations from the regression line (residuals) follow a normal distribution</li>
                <li>deviations from the regression line (residuals) have uniform variance</li>
            </ul>
            <p>&#160;</p>
            <p>This is just one facet of analysis of covariance; there are additional and alternative methods. For further information, see <a href="../references/reference_list.htm">Kleinbaum et al. (1998)</a> and <a href="../references/reference_list.htm">Armitage and Berry (1994)</a>. Analysis of covariance is best carried out as part of a broader regression modelling exercise by a Statistician.</p>
            <p>&#160;</p>
            <p><u>Technical Validation</u>
            </p>
            <p>Slopes of several regression lines are compared by analysis of variance as follows (Armitage, 1994):</p>
            <p>
                <img src="../generatedimages/equations/equation189.svg" alt="" class="mcReset" />
            </p>
            <p>- where SS<sub>common</sub> is the sum of squares due to the common slope of k regression lines, SS<sub>between</sub> is the sum of squares due to differences between the slopes, SS<sub>total</sub> is the total sum of squares and the residual sum of squares is the difference between SS<sub>total</sub> and SS<sub>common</sub>. Sxx<sub>j</sub> is the sum of squares about the mean x observation in the jth group, SxY<sub>j</sub> is the sum of products of the deviations of xY pairs from their means in the jth group and SYY<sub>j</sub> is the sum of squares about the mean Y observation in the jth group.</p>
            <p>&#160;</p>
            <p>Vertical separation of slopes of several regression lines is tested by analysis of covariance as follows (Armitage, 1994):</p>
            <p>
                <img src="../generatedimages/equations/equation190.svg" alt="" class="mcReset" />
            </p>
            <p>- where SS are corrected sums of squares within the groups, total and between the groups (subtract within from total). The constituent sums of products or squares are partitioned between groups, within groups and total as above.</p>
            <p>&#160;</p>
            <p><u>Data preparation</u>
            </p>
            <p>If there are equal numbers of replicate Y observations or single Y observations for each x then you are best prepare and select your data using a group identifier variable. For example with three replicates you would prepare five columns of data: group identifier, x, y1, y2, and y3. Remember to choose the "Groups by identifier" option in this case.</p>
            <p>&#160;</p>
            <p>If there are unequal numbers of replicate Y observations for each x then you must prepare the x data in separate columns by group, prepare the Y data in separate columns by group and observation (i.e. Y for group 1 observation 1… r rows long where r is the number of repeat observations). Remember to choose the "Groups by column" option in this case. This is done in the example below.</p>
            <p>&#160;</p>
            <p><u>Example</u>
            </p>
            <p>From <a href="../references/reference_list.htm">Armitage and Berry (1994)</a>.</p>
            <p>Test workbook (Regression worksheet: Log Dose_Std, BD 1_Std, BD 2_Std, BD 3_Std, Log Dose_I, BD 1_I, BD 2_I, BD 3_I, Log Dose_F, BD 1_F, BD 2_F, BD 3_F).</p>
            <p>&#160;</p>
            <p>Three different preparations of Vitamin D are tested for their effect on bones by feeding them to rats that have an induced lack of mineral in their bones. X-ray methods are used to test the re-mineralisation of bones in response to the Vitamin D.</p>
            <p>&#160;</p>
            <p>For the standard preparation:</p>
            <table>
                <col />
                <col />
                <col />
                <tr>
                    <td colspan="3">
                        <p><u>Log dose of Vit D</u>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>0.544</p>
                    </td>
                    <td>
                        <p>0.845</p>
                    </td>
                    <td>
                        <p>1.146</p>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <p><u>Bone density score</u>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>0</p>
                    </td>
                    <td>
                        <p>1.5</p>
                    </td>
                    <td>
                        <p>2</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>0</p>
                    </td>
                    <td>
                        <p>2.5</p>
                    </td>
                    <td>
                        <p>2.5</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>1</p>
                    </td>
                    <td>
                        <p>5</p>
                    </td>
                    <td>
                        <p>5</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>2.75</p>
                    </td>
                    <td>
                        <p>6</p>
                    </td>
                    <td>
                        <p>4</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>2.75</p>
                    </td>
                    <td>
                        <p>4.25</p>
                    </td>
                    <td>
                        <p>5</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>1.75</p>
                    </td>
                    <td>
                        <p>2.75</p>
                    </td>
                    <td>
                        <p>4</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>2.75</p>
                    </td>
                    <td>
                        <p>1.5</p>
                    </td>
                    <td>
                        <p>2.5</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>2.25</p>
                    </td>
                    <td>
                        <p>3</p>
                    </td>
                    <td>
                        <p>3.5</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>2.25</p>
                    </td>
                    <td>
                        <p>&#160;</p>
                    </td>
                    <td>
                        <p>3</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>2.5</p>
                    </td>
                    <td>
                        <p>&#160;</p>
                    </td>
                    <td>
                        <p>2</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>&#160;</p>
                    </td>
                    <td>
                        <p>&#160;</p>
                    </td>
                    <td>
                        <p>3</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>&#160;</p>
                    </td>
                    <td>
                        <p>&#160;</p>
                    </td>
                    <td>
                        <p>4</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>&#160;</p>
                    </td>
                    <td>
                        <p>&#160;</p>
                    </td>
                    <td>
                        <p>4</p>
                    </td>
                </tr>
            </table>
            <p>&#160;</p>
            <p>For alternative preparation I:</p>
            <table>
                <col />
                <col />
                <col />
                <col />
                <col />
                <tr>
                    <td colspan="5"><u>Log dose of Vit D</u>
                    </td>
                </tr>
                <tr>
                    <td>0.398</td>
                    <td>0.699</td>
                    <td>1.000</td>
                    <td>1.301</td>
                    <td>1.602</td>
                </tr>
                <tr>
                    <td colspan="5"><u>Bone density score</u>
                    </td>
                </tr>
                <tr>
                    <td>0</td>
                    <td>1</td>
                    <td>1.5</td>
                    <td>3</td>
                    <td>3.5</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>1.5</td>
                    <td>1</td>
                    <td>3</td>
                    <td>3.5</td>
                </tr>
                <tr>
                    <td>0</td>
                    <td>1.5</td>
                    <td>2</td>
                    <td>5.5</td>
                    <td>4.5</td>
                </tr>
                <tr>
                    <td>0</td>
                    <td>1</td>
                    <td>3.5</td>
                    <td>2.5</td>
                    <td>3.5</td>
                </tr>
                <tr>
                    <td>0</td>
                    <td>1</td>
                    <td>2</td>
                    <td>1</td>
                    <td>3.5</td>
                </tr>
                <tr>
                    <td>0.5</td>
                    <td>0.5</td>
                    <td>0</td>
                    <td>2</td>
                    <td>3</td>
                </tr>
            </table>
            <p>&#160;</p>
            <p>For alternative preparation F:</p>
            <table>
                <col />
                <col />
                <col />
                <tr>
                    <td colspan="3"><u>Log dose of Vit D</u>
                    </td>
                </tr>
                <tr>
                    <td>0.398</td>
                    <td>0.699</td>
                    <td>1.000</td>
                </tr>
                <tr>
                    <td colspan="3"><u>Bone density score</u>
                    </td>
                </tr>
                <tr>
                    <td>2.75</td>
                    <td>2.5</td>
                    <td>3.75</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>2.75</td>
                    <td>5.25</td>
                </tr>
                <tr>
                    <td>1.25</td>
                    <td>2.25</td>
                    <td>6</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>2.25</td>
                    <td>5.5</td>
                </tr>
                <tr>
                    <td>0</td>
                    <td>3.75</td>
                    <td>2.25</td>
                </tr>
                <tr>
                    <td>0.5</td>
                    <td>&#160;</td>
                    <td>3.5</td>
                </tr>
            </table>
            <p>&#160;</p>
            <p>To analyse these data in StatsDirect you must first enter them into 14 columns in the workbook appropriately labelled. The first column is just three rows long and contains the three log doses of vitamin D for the standard preparation. The next three columns represent the repeated measures of bone density for each of the three levels of log dose of vitamin D which are represented by the rows of the first column. This is then repeated for the other two preparations. Alternatively, open the test workbook using the file open function of the file menu. Then select covariance from the groups section of the regression and correlation section of the analysis menu. <a href="../workbook/selecting_data.htm">Select</a> the columns marked "Log Dose_Std", "Log Dose_I" and "Log Dose_F" when you are prompted for the predictor (x) variables, these contain the log dose levels (logarithms are taken because, from previous research, the relationship between bone re-mineralisation and Vitamin D is known to be <a href="../data_preparation/transformations.htm">log-linear</a>). Make sure that the "use Y replicates" option is checked when you are prompted for it. Then select the outcome (Y) variables that represent the replicates. You will have to select three, five and three columns in just three <a href="../workbook/selecting_data.htm">selection</a> actions because these are the number of corresponding dose levels in the x variables in the order in which you selected them.</p>
            <p>&#160;</p>
            <p>Alternatively, these data could have been entered in just three pairs of workbook columns representing the three preparations with a log dose column and column of the mean bone density score for each dose level. By accepting the more long winded input of replicates, StatsDirect is encouraging you to run a test of <a href="grouped_linearity_replicates.htm">linearity</a> on your data.</p>
            <p>&#160;</p>
            <p>For this example:</p>
            <p>&#160;</p>
            <p><u>Grouped linear regression</u>
            </p>
            <p>&#160;</p>
            <table>
                <col />
                <col />
                <col />
                <col />
                <col />
                <col />
                <tr>
                    <td style="text-decoration: underline;">Source of variation</td>
                    <td style="text-decoration: underline;">SSq</td>
                    <td style="text-decoration: underline;">DF</td>
                    <td style="text-decoration: underline;">MSq</td>
                    <td style="text-decoration: underline;">VR</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td>Common slope</td>
                    <td>78.340457</td>
                    <td>1</td>
                    <td>78.340457</td>
                    <td>67.676534</td>
                    <td>P &lt; 0.0001</td>
                </tr>
                <tr>
                    <td>Between slopes</td>
                    <td>4.507547</td>
                    <td>2</td>
                    <td>2.253774</td>
                    <td>1.946984</td>
                    <td>P = 0.1501</td>
                </tr>
                <tr>
                    <td>Separate residuals</td>
                    <td>83.34518</td>
                    <td>72</td>
                    <td>1.157572</td>
                    <td>&#160;</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td>Within groups</td>
                    <td>166.193185</td>
                    <td>75</td>
                    <td>&#160;</td>
                    <td>&#160;</td>
                    <td>&#160;</td>
                </tr>
            </table>
            <p>&#160;</p>
            <p>Common slope is significant</p>
            <p>Difference between slopes is NOT significant</p>
            <p>&#160;</p>
            <p>Slope comparisons:</p>
            <p>slope 1 (Log Dose_Std) v slope 2 (Log Dose_I) = 2.616751 v 2.796235</p>
            <p>Difference (95% CI) = 0.179484 (-1.576065 to 1.935032)</p>
            <p>t = -0.203808, P = 0.8391</p>
            <p>slope 1 (Log Dose_Std) v slope 3 (Log Dose_F) = 2.616751 v 4.914175</p>
            <p>Difference (95% CI) = 2.297424 (-0.245568 to 4.840416)</p>
            <p>t = -1.800962, P = 0.0759</p>
            <p>slope 2 (Log Dose_I) v slope 3 (Log Dose_F) = 2.796235 v 4.914175</p>
            <p>Difference (95% CI) = 2.11794 (-0.135343 to 4.371224)</p>
            <p>t = -1.873726, P = 0.065</p>
            <p>&#160;</p>
            <p><u>Covariance analysis</u>
            </p>
            <p>Uncorrected:</p>
            <table>
                <col />
                <col />
                <col />
                <col />
                <col />
                <tr>
                    <td style="text-decoration: underline;">Source of variation</td>
                    <td style="text-decoration: underline;">YY</td>
                    <td style="text-decoration: underline;">xY</td>
                    <td style="text-decoration: underline;">xx</td>
                    <td style="text-decoration: underline;">DF</td>
                </tr>
                <tr>
                    <td>Between groups</td>
                    <td>17.599283</td>
                    <td>-3.322801</td>
                    <td>0.988515</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>Within</td>
                    <td>166.193185</td>
                    <td>25.927266</td>
                    <td>8.580791</td>
                    <td>8</td>
                </tr>
                <tr>
                    <td>Total</td>
                    <td>183.792468</td>
                    <td>22.604465</td>
                    <td>9.569306</td>
                    <td>10</td>
                </tr>
            </table>
            <p>&#160;</p>
            <p>Corrected:</p>
            <table>
                <col />
                <col />
                <col />
                <col />
                <col />
                <tr>
                    <td style="text-decoration: underline;">Source of variation</td>
                    <td style="text-decoration: underline;">SSq</td>
                    <td style="text-decoration: underline;">DF</td>
                    <td style="text-decoration: underline;">MSq</td>
                    <td style="text-decoration: underline;">VR</td>
                </tr>
                <tr>
                    <td>Between groups</td>
                    <td>42.543829</td>
                    <td>2</td>
                    <td>21.271915</td>
                    <td>1.694921</td>
                </tr>
                <tr>
                    <td>Within</td>
                    <td>87.852727</td>
                    <td>7</td>
                    <td>12.55039</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td>Total</td>
                    <td>130.396557</td>
                    <td>9</td>
                    <td>&#160;</td>
                    <td>&#160;</td>
                </tr>
            </table>
            <p>P = 0.251</p>
            <p>&#160;</p>
            <p>Corrected Y means ± SE for baseline mean predictor of 0.884372:</p>
            <p>Y' = 2.901917	± 2.045389</p>
            <p>Y' = 1.533957	± 1.590482</p>
            <p>Y' = 3.398345	± 2.057601</p>
            <p>&#160;</p>
            <p>Line separations (common slope =3.021547):</p>
            <p>line 1 (Log Dose_Std) vs line 2 (Log Dose_I) Vertical separation = 1.367959</p>
            <p>95% CI = -4.760348 to 7.496267</p>
            <p>t = 0.527831, (7 df), P = 0.6139</p>
            <p>line 1 (Log Dose_Std) vs line 3 (Log Dose_F) Vertical separation = -0.496428</p>
            <p>95% CI = -7.354566 to 6.36171</p>
            <p>t = -0.171164, (7 df), P = 0.8689</p>
            <p>line 2 (Log Dose_I) vs line 3 (Log Dose_F) Vertical separation = -1.864388</p>
            <p>95% CI = -8.042375 to 4.3136</p>
            <p>t = -0.713594, (7 df), P = 0.4986</p>
            <p>&#160;</p>
            <p>The common slope is highly significant and the test for difference between the slopes overall was non-significant. If our assumption of linearity holds true we can conclude that these lines are reasonably parallel. Looking more closely at the individual slopes preparation F is almost shown to be significantly different from the other two but this difference was not large enough to throw the overall slope comparison into a significant heterogeneity.</p>
            <p>&#160;</p>
            <p>The analysis of covariance did not show any significant vertical separation of the three regression lines.</p>
            <p>&#160;</p>
            <p><a href="../basics/p_values.htm">P values</a>
            </p>
        </div>
        <p>
            <MadCap:pageFooter>
                <p style="font-family: sans-serif;font-size: 6pt;">&#160;</p>
                <p style="font-family: sans-serif;font-size: 8pt;">&#160;</p>
                <p style="font-family: sans-serif;font-size: 8pt;"><span style="font-size: 8pt;">Copyright © 1987-2025 Iain E. Buchan, all rights reserved. </span><a href="https://www.statsdirect.com/Download.aspx" style="font-size: 8pt;">Download software here</a><span style="font-size: 8pt;">.</span>
                </p>
            </MadCap:pageFooter>
        </p>
    </body>
    <script type="text/javascript">/* <![CDATA[ */
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-45008526-2']);
		_gaq.push(['_trackPageview']);
		(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	/* ]]> */</script>
</html>