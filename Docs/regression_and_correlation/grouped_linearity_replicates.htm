<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Regression and correlation">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Linearity of Regression - StatsDirect</title>
        <script type="text/javascript">
        </script>
        <link href="../resources/stylesheets/statsdirect.css" rel="stylesheet" type="text/css" />
        <script src="../resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/foundation.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../index.html#regression_and_correlation/grouped_linearity_replicates.htm">Open topic with navigation</a>
        </p>
        <h1><a name="kanchor189"></a>Linearity with Replicates of the Outcome (Y)</h1>
        <p>&#160;</p>
        <p>Menu location: <b>Analysis_Regression and Correlation_Grouped Linear_Linearity</b>.</p>
        <p>&#160;</p>
        <p>This function gives a test for linearity in a <a href="simple_linear.htm">simple linear regression</a> model when the response/outcome variable (Y) has been measured repeatedly.</p>
        <p>&#160;</p>
        <p>The standard analysis of variance for simple (one predictor) linear regression tests for the possibility that the observed data fit to a straight line but it does not test whether or not a straight line model is appropriate in the first place. This function can be used to test that assumption of linearity.</p>
        <p>&#160;</p>
        <p>For studies that employ linear regression, it is worth collecting repeat Y observations. This enables you to run a test of linearity and thus justify or refute the use of linear regression in subsequent analysis (<a href="../references/reference_list.htm">Armitage and Berry, 1994</a>). Replicate Y observations should be entered in separate workbook columns (variables), one column for each observation in the predictor (x) variable. The number of Y replicate variables which you are prompted to select is the number of rows in the x variable.</p>
        <p>&#160;</p>
        <p>Please note that the repeats of Y observations should be arranged in a worksheet so that each Y column contains repeats of a single Y observation that matches an x observation (i.e. row 4 of x should relate to column 4 of Y repeats). If your data are arranged so that each repeat of Y is in a separate column then use the <a href="../data_preparation/rotate_block.htm">Rotate Data Block</a> function of the Data menu on your Y data before selecting them for this function.</p>
        <p>&#160;</p>
        <p>Assumptions:</p>
        <ul>
            <li>Y replicates are a random sample from a normal distribution</li>
            <li>deviations from the regression line (residuals) follow a normal distribution</li>
            <li>deviations from the regression line (residuals) have uniform variance</li>
        </ul>
        <p>&#160;</p>
        <p>Generalisations of this method to models with more than one predictor are available (<a href="../references/reference_list.htm">Draper and Smith, 1998</a>). Generalised replicate analysis is best done as a part of exploratory modelling by a Statistician.</p>
        <p>&#160;</p>
        <p><u>Technical Validation</u>
        </p>
        <p>Linearity is tested by analysis of variance for the linear regression of k outcome observations for each level of the predictor variable (Armitage, 1994):</p>
        <p>
            <img src="../generatedimages/equations/equation191.svg" alt="" class="mcReset" />
        </p>
        <p>- where SS<sub>regression</sub> is the sum of squares due to the regression of Y on x, SS<sub>repeats</sub> is the part of the usual residual sum of squares that is due to variation within repeats of the outcome observations, SS<sub>total</sub> is the total sum of squares and the remainder represents the sum of squares due to deviation of the means of repeated outcome observations from the regression. Y is the outcome variable, x is the predictor variable, N is the total number of Y observations and n<sub>j</sub> is the number of Y repeats for the jth x observation.</p>
        <p>&#160;</p>
        <p><u>Example</u>
        </p>
        <p>From <a href="../references/reference_list.htm">Armitage and Berry (1994, p. 288)</a>.</p>
        <p>Test workbook (Regression worksheet: Log Dose_Std, BD 1_Std, BD 2_Std, BD 3_Std).</p>
        <p>&#160;</p>
        <p>A preparation of Vitamin D is tested for its effect on bones by feeding it to rats that have an induced lack of mineral in their bones. X-ray methods are used to test the re-mineralisation of bones in response to the Vitamin D.</p>
        <p>&#160;</p>
        <table>
            <col />
            <col />
            <col />
            <tr>
                <td colspan="3"><u>Log dose of Vit D</u>
                </td>
            </tr>
            <tr>
                <td>0.544</td>
                <td>0.845</td>
                <td>1.146</td>
            </tr>
            <tr>
                <td colspan="3"><u>Bone density score</u>
                </td>
            </tr>
            <tr>
                <td>0</td>
                <td>1.5</td>
                <td>2</td>
            </tr>
            <tr>
                <td>0</td>
                <td>2.5</td>
                <td>2.5</td>
            </tr>
            <tr>
                <td>1</td>
                <td>5</td>
                <td>5</td>
            </tr>
            <tr>
                <td>2.75</td>
                <td>6</td>
                <td>4</td>
            </tr>
            <tr>
                <td>2.75</td>
                <td>4.25</td>
                <td>5</td>
            </tr>
            <tr>
                <td>1.75</td>
                <td>2.75</td>
                <td>4</td>
            </tr>
            <tr>
                <td>2.75</td>
                <td>1.5</td>
                <td>2.5</td>
            </tr>
            <tr>
                <td>2.25</td>
                <td>3</td>
                <td>3.5</td>
            </tr>
            <tr>
                <td>2.25</td>
                <td>&#160;</td>
                <td>3</td>
            </tr>
            <tr>
                <td>2.5</td>
                <td>&#160;</td>
                <td>2</td>
            </tr>
            <tr>
                <td>&#160;</td>
                <td>&#160;</td>
                <td>3</td>
            </tr>
            <tr>
                <td>&#160;</td>
                <td>&#160;</td>
                <td>4</td>
            </tr>
            <tr>
                <td>&#160;</td>
                <td>&#160;</td>
                <td>4</td>
            </tr>
        </table>
        <p>&#160;</p>
        <p>To analyse these data in StatsDirect you must first enter them into four columns in the workbook and label them appropriately. The first column is just three rows long and contains the three log doses of Vitamin D above (logarithms are taken because, from previous research, the relationship between bone re-mineralisation and Vitamin D is known to be <a href="../data_preparation/transformations.htm">log-linear</a>). The next three columns represent the repeated measures of bone density for each of the three levels of log dose of Vitamin D which are represented by the rows of the first column. Alternatively, open the test workbook using the file open function of the file menu. Then select linearity from the groups section of the regression and correlation section of the analysis menu. <a href="../workbook/selecting_data.htm">Select</a> the column marked "Log Dose_Std" when you are prompted for the x variable, this contains the three log dose levels. Then <a href="../workbook/selecting_data.htm">select</a>, in one action, the three Y columns "BD 1_Std", "BD 2_Std" and "BD 3_Std" which correspond to each row (level) of the x variable i.e. 0.544 --&gt; 0.845 --&gt; 1.146.</p>
        <p>&#160;</p>
        <p>For this example:</p>
        <p>&#160;</p>
        <p><u>Linearity with replicates of Y</u>
        </p>
        <p>&#160;</p>
        <table>
            <col />
            <col />
            <col />
            <col />
            <col />
            <col />
            <tr>
                <td style="text-decoration: underline;">Source of variation</td>
                <td style="text-decoration: underline;">SSq</td>
                <td style="text-decoration: underline;">DF</td>
                <td style="text-decoration: underline;">MSq</td>
                <td style="text-decoration: underline;">VR</td>
                <td>&#160;</td>
            </tr>
            <tr>
                <td>Due 
		 to regression</td>
                <td>14.088629</td>
                <td>1</td>
                <td>14.088629</td>
                <td>9.450512</td>
                <td>P = .0047</td>
            </tr>
            <tr>
                <td>Deviation 
		 of x means</td>
                <td>2.903415</td>
                <td>1</td>
                <td>2.903415</td>
                <td>1.947581</td>
                <td>P = .1738</td>
            </tr>
            <tr>
                <td>Within x residual</td>
                <td>41.741827</td>
                <td>28</td>
                <td>1.49078</td>
                <td>&#160;</td>
                <td>&#160;</td>
            </tr>
            <tr>
                <td>Total</td>
                <td>58.733871</td>
                <td>30</td>
                <td>&#160;</td>
                <td>&#160;</td>
                <td>&#160;</td>
            </tr>
        </table>
        <p>&#160;</p>
        <p>Regression slope is significant</p>
        <p>Assumption of linearity supported</p>
        <p>&#160;</p>
        <p>Thus the regression itself (meaning the slope) was statistically highly significant. If the deviations from x means had been significant then we should have rejected our assumption of linearity, as it stands they were not.</p>
        <p>&#160;</p>
        <p><a href="../basics/p_values.htm">P values</a>
        </p>
        <p><a href="nonlinear.htm">non-linear models</a>
        </p>
    </body>
</html>